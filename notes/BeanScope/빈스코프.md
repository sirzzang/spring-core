# 빈 스코프

 스코프는 **빈이 존재할 수 있는 범위**를 의미한다.
 
## 종류

 스프링이 지원하는 빈 스코프는 다음과 같다.
* [싱글톤](scope/빈스코프_싱글톤스코프.md)
* [프로토타입](scope/빈스코프_프로토타입.md)
* 웹 관련 스코프
  * [request](scope/빈스코프_request.md)
  * session
  * application

> 싱글톤, 프로토타입, request 정도만 알아 둬도 실무에서 큰 문제는 없다. 

<br>

### 싱글톤

 스프링 컨테이너의 시작부터 종료까지 유지되는 가장 넓은 범위의 스코프
* 기본 스코프
* 객체 생성, 싱글톤 관리 등 모두 스프링 컨테이너가 관리

> 지금까지 만든 스프링 빈은 스프링 컨테이너의 시작과 함께 생성되어서, 스프링 컨테이너가 종료될 때까지 유지된다. 이는 기본적으로, 지금까지 만들었던 스프링 빈이 **싱글톤 스코프**로 생성되기 때문이다. 

<br>

### 프로토타입

 스프링 컨테이너가 생성과 의존관계 주입까지만 관리하는 스코프
* 스프링 컨테이너가 요청 시 빈을 만들고 의존관계 주입 시 초기화 메서드까지 부른 후 클라이언트에게 반환
* 클라이언트에게 반환 후 스프링 컨테이너는 관리하지 않음

<br>

### 웹 관련 스코프

 웹 환경에서만 동작하는, 스프링 컨테이너가 종료 시점까지 관리하는 스코프
* 종료 메서드가 호출됨

#### request

 웹 요청 하나가 들어오고 나갈 때까지 유지되는 스코프. HTTP 요청과 동일한 생명주기를 가지며, 각각의 HTTP 요청마다 별도의 빈 인스턴스가 생성되고 관리된다.
* 요청이 들어올 때 생성
* 요청이 끝날 때 파괴

#### session

 웹 세션이 생성되고 종료될 때까지 유지되는 스코프. HTTP 세션과 동일한 생명주기를 가진다. 

#### application

 웹의 서블릿 컨텍스트와 같은 범위로 유지되는 스코프. 서블릿 컨텍스트와 동일한 생명주기를 가진다.

#### websocket

 웹소켓과 동일한 생명주기를 가지는 스코프


## 사용

빈 스코프를 지정할 때는 `@Scope` 애노테이션을 이용
* `value`: 빈 스코프 타입 지정(생략 가능)
  * `@Scope(value = "singleton")`: 싱글톤. 기본값
  * `@Scope(value = "prototype")`: 프로토타입
  * `@Scope(value = "request")`: request 스코프
* `proxyMode`: 프록시 모드 지정
  * `@Scope(proxyMode = scopedProxyMode.INTERFACES)`: 프록시 모드 적용 대상이 인터페이스일 때 
  * `@Scope(proxyMode = ScopedProxyMode.TARGET_CLASS)`: 프록시 모드 적용 대상이 클래스일 때

# 주의
 특별한 스코프는 꼭 필요한 곳에만 최소화해서 사용해야 한다. 무분별하게 사용하면 유지보수하기 어려워진다.